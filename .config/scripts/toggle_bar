#!/usr/bin/env bash

bar_height=$(sketchybar --query bar | jq '.height')
current_offset=$(sketchybar --query bar | jq '.y_offset')

if [ "$((-current_offset))" != "$bar_height" ]; then
	sketchybar -m --animate tanh 20 --bar y_offset=$((-bar_height))
	yabai -m config external_bar all:0:0
	launchctl load -F /System/Library/LaunchAgents/com.apple.OSDUIHelper.plist >/dev/null 2>&1 &
else
	current_padding=$(sketchybar --query bar | jq -r '.margin')
	bar_offset="$((current_padding + bar_height))"
	yabai -m config external_bar all:$bar_offset:0
	sketchybar -m --animate tanh 10 --bar y_offset="$current_padding"
	launchctl unload -F /System/Library/LaunchAgents/com.apple.OSDUIHelper.plist >/dev/null 2>&1 &
fi

sketchybar --update
